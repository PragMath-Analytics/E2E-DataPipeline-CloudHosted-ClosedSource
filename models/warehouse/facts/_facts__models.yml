# Note: "tests" are now called "data_tests" & have been updated accordingly
# You may delete these comments
version: 2

models:
  - name: fct_games_played
    description: '{{ doc("fct_games_played_description") }}'
    columns:
      - name: fct_game_played_sk
        data_tests:
          - not_null
          - unique
        description: A surrogate key that uniquely identifies each game played. It is generated by concatenating the game_sk, home_team_sk, away_team_sk, and game_date_sk, then applying an MD5 hash to the resulting string.
        data_type: text
      - name: game_sk
        description: This is a unique identifier for each game. It is a text field that is derived from the 'dim_games' table in the database.
        data_type: text
      - name: home_team_sk
        description: This is a unique identifier for the home team in a specific game. It is derived from the 'team_sk' column in the 'dim_teams' table.
        data_type: text
      - name: away_team_sk
        description: This is a unique identifier for the away team in a specific game. It is derived from the 'team_sk' column in the 'dim_teams' table.
        data_type: text
      - name: game_date_sk
        description: A surrogate key generated using the MD5 hash function. It is created by concatenating the game date (in text format) with a null placeholder string ('_dbt_utils_surrogate_key_null_') in case of null values. This key uniquely identifies each game based on the date it was played.
        data_type: text
      - name: home_team_score_total
        description: This column represents the total score of the home team for a particular game.
        data_type: integer
      - name: home_team_score_quarter_1
        description: This column represents the total score of the home team at the end of the first quarter.
        data_type: integer
      - name: home_team_score_quarter_2
        description: This column represents the total score of the home team during the second quarter of the game.
        data_type: integer
      - name: home_team_score_quarter_3
        description: This column represents the total score of the home team at the end of the third quarter.
        data_type: integer
      - name: home_team_score_quarter_4
        description: The total score of the home team at the end of the fourth quarter.
        data_type: integer
      - name: home_team_score_overtime
        description: This column represents the total score of the home team during the overtime period of the game.
        data_type: integer
      - name: average_home_pts_per_quarter
        description: This column represents the average points scored by the home team per quarter. It is calculated by dividing the total home team score by 4. The value is rounded to two decimal places.
        data_type: numeric
      - name: away_team_score_total
        description: This column represents the total score of the away team for a particular game.
        data_type: integer
      - name: away_team_score_quarter_1
        description: This column represents the total score of the away team during the first quarter of the game.
        data_type: integer
      - name: away_team_score_quarter_2
        description: The total score of the away team in the second quarter of the game.
        data_type: integer
      - name: away_team_score_quarter_3
        description: The total score of the away team at the end of the third quarter.
        data_type: integer
      - name: away_team_score_quarter_4
        description: The total score of the away team at the end of the fourth quarter.
        data_type: integer
      - name: away_team_score_overtime
        description: This column represents the total score of the away team during the overtime period of the game.
        data_type: integer
      - name: average_away_pts_per_quarter
        description: This column represents the average points scored by the away team per quarter. It is calculated by dividing the total score of the away team by 4. The value is rounded to two decimal places.
        data_type: numeric
      - name: point_differential
        description: The point differential column represents the difference in points between the home team and the away team at the end of the game. A positive value indicates that the home team scored more points than the away team, while a negative value indicates that the away team scored more points than the home team.
        data_type: integer
      - name: home_team_win_count
        description: This column represents the total number of games won by the home team. It is calculated as 1 if the home team wins the game, otherwise 0.
        data_type: integer
      - name: home_team_loss_count
        description: This column represents the total number of losses for the home team. It is calculated as 1 if the home team did not win the game, otherwise 0.
        data_type: integer
      - name: away_team_win_count
        description: This column represents the count of games won by the away team. It is derived from the 'is_away_team_win' field in the 'games' table. If the away team won the game, the value will be 1, otherwise it will be 0.
        data_type: integer
      - name: away_team_loss_count
        description: This column represents the total number of losses for the away team. It is calculated as 1 if the away team did not win the game, otherwise 0.
        data_type: integer
      - name: game_at
        description: This column represents the timestamp of when the game was played. It does not include the time zone.
        data_type: timestamp without time zone
